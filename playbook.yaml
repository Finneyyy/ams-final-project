- hosts: all
  remote_user: ubuntu
  become: yes
  vars:
    git_version: latest
    nginx_version: latest
    nginx_conf_file: /etc/nginx/nginx.conf
    java_version: openjdk-11-jdk
    docker_version: latest

  tasks:

  - name: Add Docker GPG apt Key
    apt_key:
      url: https://download.docker.com/linux/ubuntu/gpg
      state: present

  - name: Add Docker Repository
    apt_repository:
      repo: deb https://download.docker.com/linux/ubuntu focal stable
      state: present

  - name: Update apt and install docker and compose
    apt:
      name: 
        - docker-ce
        - docker-compose
      state: latest
      update_cache: true

  - name: Install Java
    shell: apt install -y openjdk-11-jre-headless 

  - name: Install nginx
    shell: apt install -y nginx

  - name: Install Node.js
    shell: apt install -y nodejs

  - name: copy to remote system
    copy: 
      src: role/dockerswarm/files/docker-compose.yml
      dest: /home/ubuntu/docker-compose.yml
      owner: ubuntu

  # runs the dockerswarm stuff
- hosts: all
  become: true
  roles:
    - dockerswarm
  tasks: 
  # call the container use docker exec to ls then find path for replace module
  # then register it as variable

  - name: install ansible 
    shell: sudo apt install ansible

  - name: Install docker galaxy
    shell: ansible-galaxy collection install community.docker







